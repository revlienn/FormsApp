<h1 class="text-3xl">Registration</h1>

<form action="" [formGroup]="reactiveRegisterForm" (submit)="register()">
   @if(!stepTwo){
   <fieldset>
      <legend class="fieldset-legend">Email</legend>
      <input name="email" [formControl]="email" placeholder="Email address" type="email" class="input">
      @if(email.touched && email.valid){
      <fa-icon [icon]="faCheck" class="ps-2 text-green-600" />
      }

   </fieldset>
   <fieldset>
      <legend class="fieldset-legend">Password</legend>
      <input name="password" [formControl]="password" placeholder="Password" type="password" class="input">
      @if(password.touched && password.valid){
      <fa-icon [icon]="faCheck" class="ps-2 text-green-600" />
      }
   </fieldset>
   @if(password.touched && password.errors?.['passwordStrength']){
   <span class="text-red-500 italic">Minimum 8 characters, must contain uppercase, lowercase, and a number</span><br>
   }
   }


   @if(stepTwo){
   <fieldset>
      <legend class="fieldset-legend">Username</legend>
      <input name="username" [formControl]="username" placeholder="Username" type="username" class="input">
      @if(username.touched && username.valid ){
      <fa-icon [icon]="faCheck" class="ps-2 text-green-600" />
      }
      @if(username.errors?.['usernameTaken']){
      <br><span class="italic text-red-500">Username has been taken</span>
      }
   </fieldset>

   
   <mat-form-field class="mt-3">
      <input matInput [matDatepicker]="picker" placeholder="Starting Date" [formControl]="startDate">
      <mat-hint>MM/DD/YYYY</mat-hint>
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
   </mat-form-field>

   <section>
      <mat-checkbox (change)="annualToggle($event)">Annual Membership</mat-checkbox>
   </section>

   <section class="w-[50vw]">
      <mat-form-field>
         <mat-label>Leave a comment</mat-label>
         <textarea matInput name="" id="" [formControl]="comment"></textarea>
         <mat-hint>min.10 characters</mat-hint>
      </mat-form-field>
   </section>

   <section>
      <mat-form-field>
         <mat-label>Choose membership type</mat-label>
         <mat-select [formControl]="membershipType">
            @for(t of membershipTypes;track $index){
               <mat-option [value]="t">{{t}}</mat-option>
            }
         </mat-select>
      </mat-form-field>
   </section>

   }
   <div class="flex gap-3 mt-4">
      <button type="button" (click)="reset()" class="btn btn-outline btn-warning">Reset</button>
      <button type="button" (click)="toggleStep()" class="btn btn-accent">{{stepTwo?'Back':'Next'}}</button>
      <button type="submit" [disabled]="!reactiveRegisterForm.valid" class="btn btn-primary">Register</button>
   </div>

</form>

<div>
   VALUE : {{reactiveRegisterForm.value|json}} <br>
   VALID : {{reactiveRegisterForm.valid}}
</div>